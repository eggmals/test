<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Korean Waffle</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Nunito:wght@400;700&display=swap" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
  </head>
  <body>
    <!-- HERO SECTION -->
    <section class="hero" id="home">
      <div class="video-background">
        <video autoplay muted loop playsinline>
          <source src="asset/waffle.mp4" type="video/mp4" />
        </video>
        <div class="video-overlay"></div>
      </div>

      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-8 mx-auto text-center">
            <h1 class="display-3 fw-bold mb-4">Korean Waffle</h1>
            <p class="lead mb-5">
              Nikmati kelezatan premium waffle Korea dalam balutan rasa istimewa
              yang akan memanjakan lidah Anda.
            </p>
            <button class="btn btn-custom mt-3" onclick="scrollToOrder()">
              Pesan Sekarang
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- MENU SECTION -->
    <section class="content-section" id="menu-section">
      <div class="container">
        <h2 class="section-title">Our Delicious Menu</h2>
        <div class="row g-4">
          <div class="col-md-4">
            <div class="card menu-card h-100">
              <img src="asset/strawberryy.png" class="card-img-top" alt="Strawberry Waffle" />
              <div class="card-body">
                <h5 class="card-title">Strawberry Waffle</h5>
                <p class="card-text">
                  Waffle renyah dengan saus stroberi dan topping marshmallow
                  warna-warni.
                </p>
                <button class="btn btn-custom w-100 mt-3" onclick="scrollToOrder()">
                  Order Now
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card menu-card h-100">
              <img src="asset/coklatt.png" class="card-img-top" alt="Chocolate Waffle" />
              <div class="card-body">
                <h5 class="card-title">Chocolate Waffle</h5>
                <p class="card-text">
                  Waffle lembut disiram saus cokelat, ditaburi almond slice
                  gurih.
                </p>
                <button class="btn btn-custom w-100 mt-3" onclick="scrollToOrder()">
                  Order Now
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card menu-card h-100">
              <img src="asset/matchaa.png" class="card-img-top" alt="Matcha Waffle" />
              <div class="card-body">
                <h5 class="card-title">Matcha Waffle</h5>
                <p class="card-text">
                  Waffle matcha dengan saus matcha dan taburan Oreo crumbs.
                </p>
                <button class="btn btn-custom w-100 mt-3" onclick="scrollToOrder()">
                  Order Now
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="content-section" id="about">
      <div class="container">
        <h2 class="section-title">About Us</h2>
        <div class="row align-items-center">
          <div class="col-lg-6 mb-4 mb-lg-0">
            <div class="about">
              <h3 class="mb-4">Premium Korean Waffle Experience</h3>
              <p>
                Korean Waffle adalah brand lokal premium yang menghadirkan cita
                rasa otentik waffle Korea dengan kualitas bahan terbaik.
              </p>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="text-center">
              <img src="waffle.png" alt="Korean Waffle" class="img-fluid rounded-circle" style="max-width: 50%" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ORDER -->
<section class="content-section" id="order">
  <div class="container">
    <h2 class="section-title">Order Now</h2>
    <div class="row">
      <!-- Form Pemesanan -->
      <div class="col-lg-7 mb-4 mb-lg-0">
        <div class="order h-100 d-flex flex-column">
          <h3 class="mb-4">Place Your Order</h3>
          <form id="formPesanan">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="nama" class="form-label">Nama Lengkap</label>
                <input type="text" class="form-control" id="nama" name="nama" required />
              </div>
              <div class="col-md-6 mb-3">
                <label for="wa" class="form-label">Nomor WhatsApp</label>
                <input type="tel" class="form-control" id="wa" name="wa" required />
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="menuSelect" class="form-label">Pilih Menu</label>
                <select class="form-select" id="menuSelect" name="menu" required>
                  <option value="" disabled selected>Pilih menu favorit Anda</option>
                  <option value="Strawberry Waffle">Strawberry Waffle</option>
                  <option value="Chocolate Waffle">Chocolate Waffle</option>
                  <option value="Matcha Waffle">Matcha Waffle</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="jumlah" class="form-label">Jumlah Pesanan</label>
                <input type="number" class="form-control" id="jumlah" name="jumlah" min="1" value="1" required />
              </div>
            </div>

            <button type="submit" class="btn btn-custom mt-auto">Tambah ke Daftar</button>
          </form>
        </div>
      </div>

      <!-- Daftar Pesanan -->
      <div class="col-lg-5">
        <div class="order h-100 d-flex flex-column">
          <h3 class="mb-4">Daftar Pesanan Anda</h3>
          <ul id="daftarPesanan" class="list-group mb-4 flex-grow-1 overflow-auto" style="max-height: 250px;"></ul>

          <!-- Input Alamat Global -->
          <div id="alamatSection" class="mb-3" style="display: none;">
            <label for="alamatGlobal" class="form-label">Alamat Pengiriman</label>
            <textarea class="form-control" id="alamatGlobal" rows="2" style="resize: none;" required></textarea>
          </div>

          <button class="btn btn-custom w-100 mt-auto" onclick="kirimSemuaPesanan()">
            Kirim Semua Pesanan
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

    <!-- CONTACT -->
    <section class="content-section" id="kontak">
      <div class="container">
        <h2 class="section-title">Contact Us</h2>
        <div class="row">
          <div class="col-lg-6 mb-4 mb-lg-0">
            <div class="contact">
              <h3 class="mb-4">Get in Touch</h3>
              <div class="contact-info">
                <div class="contact-item">
                  <div class="contact-icon">
                    <img src="asset/maps.png" alt="Location" class="img-icon" />
                  </div>
                  <div class="contact-text">
                    <h5>Alamat</h5>
                    <p>Jl. Vila Dago Tol D19/9, Serua, Ciputat</p>
                  </div>
                </div>
                <div class="contact-item">
                  <div class="contact-icon">
                    <img src="asset/wa.png" alt="WhatsApp" class="img-icon" />
                  </div>
                  <div class="contact-text">
                    <h5>WhatsApp</h5>
                    <p><a href="https://wa.me/6287826981387">0878-2698-1387</a></p>
                  </div>
                </div>
                <div class="contact-item">
                  <div class="contact-icon">
                    <img src="asset/ig.png" alt="Instagram" class="img-icon" />
                  </div>
                  <div class="contact-text">
                    <h5>Instagram</h5>
                    <p><a href="https://instagram.com/comein.sweetness">@comein.sweetness</a></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="contact">
              <div class="rounded overflow-hidden" style="height: 350px">
                <iframe
                  src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3965.6542878994555!2d106.70763389999999!3d-6.309067999999994!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e69e547dd487803%3A0x5e4f870c77aaab3d!2sAthalia%20Patisserie!5e0!3m2!1sen!2sid!4v1744990351667!5m2!1sen!2sid"
                  width="100%"
                  height="100%"
                  style="border:0"
                  allowfullscreen=""
                  loading="lazy"
                ></iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer>
      <div class="container">
        <div class="footer-content">
          <h3 class="mb-3">Korean Waffle</h3>
          <div class="footer-links">
            <a href="#home">Home</a>
            <a href="#menu-section">Menu</a>
            <a href="#about">About</a>
            <a href="#order">Order</a>
            <a href="#kontak">Contact</a>
        </div>
      </div>
    </footer>

    <script>
      const daftarPesanan = []; //array untuk menyimpan pesanan
      const daftarPesananList = document.getElementById("daftarPesanan"); //untuk menampilkan daftar pesanan
      const formPesanan = document.getElementById("formPesanan"); //form input untuk pemesanan
      const alamatSection = document.getElementById("alamatSection"); //input alamat di tampilkan jika ada pesanan
      const alamatGlobal = document.getElementById("alamatGlobal"); //text area input alamat pengiriman

      formPesanan.addEventListener("submit", function (e) {
        e.preventDefault(); //mencegah halaman reload

        const nama = formPesanan.nama.value.trim(); //mengambil pesanan dari form
        const wa = formPesanan.wa.value.trim();
        const menu = formPesanan.menu.value;
        const jumlah = parseInt(formPesanan.jumlah.value);

        if (!nama || !wa || !menu || jumlah < 1) return; //validasi data jika kosong proses di hentikan

        const pesanan = { nama, wa, menu, jumlah }; //membuat objek pesanan berisi data pemesanan
        daftarPesanan.push(pesanan); //menambhakan pesanan ke array daftar pesanan

        renderDaftarPesanan(); //menampilkan ulang daftar pesanan
        formPesanan.reset(); //mengosongkan form jika pesanan sudah dikirim
      });

      function renderDaftarPesanan() { //deklarasi fungsi
        daftarPesananList.innerHTML = ""; //menghapus isi ul atau reset

        daftarPesanan.forEach((p, i) => { //melakukan perulangan pada array daftarPesanan dengan p sebagai item dan i sebagai indeks
          const item = document.createElement("li"); //membuat elemen <li> untuk tiap pesanan
          item.className = "list-group-item d-flex justify-content-between align-items-center";
          item.innerHTML = `
            <div>
              <strong>${p.jumlah}x ${p.menu}</strong><br>
              ${p.nama} - ${p.wa}
            </div>
            <div>
              <button class="btn btn-sm btn-warning me-2" onclick="editPesanan(${i})">Edit</button>
              <button class="btn btn-sm btn-danger" onclick="hapusPesanan(${i})">Hapus</button>
            </div>
          `; //menyusun isi <li>: info pesanan + tombol edit & hapus, dengan parameter index.\
          daftarPesananList.appendChild(item); //menambahkan elemen <li> ke dalam daftar <ul>
        });

        alamatSection.style.display = daftarPesanan.length > 0 ? "block" : "none"; //menampilkan bagian alamat jika ada pesanan; sembunyikan jika kosong
      }

      function editPesanan(index) { //fungsi edit pesanan
        const p = daftarPesanan[index]; //mengambil data pesanan ke-index
        formPesanan.nama.value = p.nama; //mengisi kembali form dengan data pesanan untuk diedit
        formPesanan.wa.value = p.wa;
        formPesanan.menu.value = p.menu;
        formPesanan.jumlah.value = p.jumlah;

        daftarPesanan.splice(index, 1); //menghapus pesanan yang sedang diedit agar nanti digantikan saat submit ulang
        renderDaftarPesanan(); //render ulang daftar agar item yang dihapus tadi hilang
      }

      function hapusPesanan(index) { //menghapus pesanan dari array berdasarkan index, lalu render ulang daftar
        daftarPesanan.splice(index, 1);
        renderDaftarPesanan();
      }

      function kirimSemuaPesanan() { //fungsi ntuk mengirim seluruh daftar pesanan ke sql
        const alamat = alamatGlobal.value.trim(); //mgengambil isi input alamat

        if (daftarPesanan.length === 0) {
          alert("Silakan tambahkan pesanan terlebih dahulu."); //validasi jika tidak ada pesanan diberi peringatan
          return;
        }

        if (!alamat) {
          alert("Mohon isi alamat pengiriman."); //validasi alamat harus diisi
          return;
        }

        const pesananFinal = daftarPesanan.map(p => ({ ...p, alamat })); //membuat array baru pesananFinal dari daftarPesanan, menambahkan alamat ke tiap item

        fetch("waffle.php", {
          method: "POST",
          headers: { "Content-Type": "application/json" }, //mengirim data ke waffle.php menggunakan metode POST dalam format JSON
          body: JSON.stringify(pesananFinal)
        })
          .then(res => res.json()) //menerima respon dari sql dan di ubah ke javascript
          .then(data => {
            if (data.status === "success") {
              alert("Pesanan berhasil dikirim!"); //jika berhasil tampilkan alert berhasil dan reset form
              daftarPesanan.length = 0;
              renderDaftarPesanan();
              alamatGlobal.value = "";
            } else {
              alert("Gagal mengirim pesanan: " + data.message); //jika gagal tampilakn alert gagal
            }
          })
          .catch(err => {
            console.error("Error:", err);
            alert("Tidak dapat mengirim pesanan."); //tangani error jika fetch gagal (misalnya jaringan offline)
          });
      }

      function scrollToOrder() {
        document.getElementById("order").scrollIntoView({ behavior: "smooth" });
      }
    </script>

  </body>
</html>